### 日曜日

日記のデプロイCI (deploy.yml) を[少し修正](https://github.com/toasa/toasa.github.io/commit/f643858bc439fc2525f641ffbc945e07fda02d07)。
修正前は、専用ブランチを用意し、そこにデプロイしたいファイルを配置、[peaceiris/actions-gh-pages](https://github.com/peaceiris/actions-gh-pages) というカスタムアクションでデプロイしていた。
これは少し古いやり方のようで、
今は Github Actions で生成した成果物を直接デプロイできるようになった：

[GitHub Pages: Custom GitHub Actions Workflows (beta)](https://github.blog/changelog/2022-07-27-github-pages-custom-github-actions-workflows-beta/)

合わせて専用のカスタムアクション
[actions/upload-pages-artifact](https://github.com/actions/upload-pages-artifact), [actions/deploy-pages](https://github.com/actions/deploy-pages) が用意されている。
まあ個人でメンテナンスされているものよりは、公式？っぽい方が安心感ある。

---

新しい日記のプッシュ時にイベントを送るCI (trigger.yml) にも
Third party 製っぽいアクションがあったので、
Github API を使う方法に[置き換える](https://github.com/toasa/diary/commit/3d452664d07fc1c3e7cb3b07188037494329bc68)。

---

actions/setup-go で以下のエラーが出てた（CI上は warning という扱いなのでCIはストップしない）：

```
Failed to restore: "/usr/bin/tar" failed with error: The process '/usr/bin/tar' failed with exit code 2
```

actions/setup-go がキャッシュを復元しようとして、ファイルが見つからないよというエラー[みたい](https://ymmt.hatenablog.com/entry/2024/10/02/222243)。
@4から@5に[アップデートした](https://github.com/toasa/toasa.github.io/commit/eb89be02ec12f34bab133000d351dbe658fab53b)らエラーでなくなった。
よくわからん。

---

CI楽しい。ピタゴラスイッチみたい。
楽しさゆえ手についてない試験勉強がありますねえ。。。

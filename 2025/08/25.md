### CTF 入門

以下のサイトを見つけたので、いくつか解く：

https://ctf.cpaw.site/index.php

* [Q7.[Reversing] Can you execute ?](https://ctf.cpaw.site/questions.php?qnum=7)
  * 謎のファイルが渡されて実行せよ、という問題
  * file コマンドで調べてみると x86-64 の ELF 実行バイナリ
  * 自分の環境は Apple シリコンの mac なので直接の実行はムリ
  * Docker コンテナで x86-64 環境を作って実行
* [Q8.[Misc] Can you open this file ?](https://ctf.cpaw.site/questions.php?qnum=8)
  * 謎のファイルが渡されて開いてみよ、という問題
  * file コマンドで調べると、"Composite Document File V2 Document" とのこと
  * ググってみると Microsoft のドキュメントのフォーマット？らしい
  * Google クラウドにアップロードして Google ドキュメントとして無事オープンでき終了
* [Q16.[Network+Forensic]HTTP Traffic](https://ctf.cpaw.site/questions.php?qnum=16)
  * pcap が与えられるので、元の Web ページを再構成する問題
  * Wireshark の使い方のいい勉強になった。
  * Wireshark でパケットを見てみると HTTP パケットが飛んでいるのがわかる。
  * クライアントの URL リクエストと、サーバーからのレスポンスをもとに、Web ページを復元する。（.html 以外に、.css, .js ファイルなども返されているので、それぞれ正しいディレクトリ階層に配置してあげて、HTTP サーバーを実行すると、正解のページが見れる）。
* [Q18.[Forensic]leaf in forest](https://ctf.cpaw.site/questions.php?qnum=18)
  * 1行で膨大な長さのファイルが与えられるので、ファイルの中からキーワードを探す問題
  * ファイルの中身は、かなり重複した文字列が含まれているので sed コマンドで取り除く。
* [Q19.[Misc]Image!](https://ctf.cpaw.site/questions.php?qnum=19)
  * よくわからない zip ファイルが渡せて、フラグ文字列を見つけてという話
  * zip を解凍すると、[Open Document](https://e-words.jp/w/ODF.html)っぽい形式のファイルができる。オフィスソフトがあれば読み取れるんだろうか。
  * OpenOffice をインストールしようとして、公式サイトから .dmg ファイルをダウンロードしたが、ソフトウェアを開けず：
    * > Appleは、“OpenOffice”にMacに損害を与えたり、プライバシーを侵害する可能性のあるマルウェアが含まれていないことを検証できませんでした。
* [Q20.[Crypto]Block Cipher](https://ctf.cpaw.site/questions.php?qnum=20)
  * C 言語のソースコードを読みとり、適切なオプション引数を指定すれば解読できるというはなし。おもしろいです、まる。
* [Q21.[Reversing]reversing easy!](https://ctf.cpaw.site/questions.php?qnum=21)
  * `ELF 32-bit LSB executable, Intel 80386` という古の実行バイナリが渡される。手元の Linux 環境で objdump -d で逆アセンブルを試したが、`objdump: can't use supplied machine i386` というエラー。アーキテクチャが古すぎるのだろう。
  * Docker で古い環境を用意：
    * `$ docker run -it --rm -v /Users/tym/tmp:/ctf i386/ubuntu bash`
    * binutils パッケージをインストール
  * とりあえず objdump で逆アセンブルはできた。
  * アセンブリがずらずらと出る。main 関数を見てみると、スタックに文字を詰めている箇所が見つかる。ascii コードと照らし合わせて、フラグ文字列を見つけられた！模範的な解き方としてこれでいいのか、不安になる。
* [Q28.[Network] Can you login？](https://ctf.cpaw.site/questions.php?qnum=28)
  * 与えられた pcap を見てみると FTP のパケットが飛んでいる。
  * パケットを見てみると、ftp サーバーのIPアドレスはもちろん、ユーザ名とパスワードが平文で見れるw。これは楽しい。まるでハッカー。
  * 手元の環境で ftp コマンドを叩くと入ってない。今どきは sftp だよなあ。しょうがないので ftp-ssl パッケージをインストールする。
  * ftp サーバーのIPアドレスでログイン。ユーザ名とパスワードを入れてログイン成功。
  * sftp みたいに ls コマンドでファイル一覧を見ようとしたが、うまくいかず。どうやら ftp にはアクティブモードとパッシブモードが存在するようで、デフォルトはアクティブモードで起動するよう。パッシブモードだと ls コマンドも使えた。get で隠しファイルを取得して、フラグ文字列の取得成功。
* [Q23.[Reversing]またやらかした！](https://ctf.cpaw.site/questions.php?qnum=23)
  * printf を忘れちゃった実行バイナリを渡される。やっぱり 80386 のバイナリ。Docker で環境を用意して、逆アセンブリして、アセンブリを眺める。
  * Q21 と同じように、main 関数の中でスタックに文字を詰めていそうな箇所が見つかる。ただそのまま ascii コードとして見ても意味不明な文字列が出てきてうまくいかない。
  * というわけで、逆コンパイルという、実行バイナリからソースコードを復元するという謎技術(!?)を試す。[dogbolt](https://dogbolt.org/) というオンラインのツールが使えた。（godbolt というオンラインコンパイラを文字ったサイトなんだろう。シャレが効いてる。）
  * 逆コンパイルされたコードを見てみると、単なる ascii コードではなく、暗号化のために一工夫された処理が入っているのがわかる。自分のアセンブリ力だとこりゃわからんわ。ツールさまさまです。
* [Q24.[Web]Baby's SQLi - Stage 2-](https://ctf.cpaw.site/questions.php?qnum=24)
  * テーブルの一覧を取得するクエリを調べる。
  * その方法は各種DBで異なるようで、問題のサイトは SQLite を使っているっぽい。`SELECT name FROM sqlite_master WHERE type='table';` でテーブル一覧を取得できた。
  * WIP

問題の難易度が自分にとってちょうどよく、
CTF とはなんぞやという入門ができた。
この作者はすごい力量だな。作問力が素晴らしい。
### デュアルブート

昨晩ミニPCが届いた。
これで3台目。
１台目と２台目はどちらも返品済み
（それぞれ、ファンがうるさかったため、[描画周りがおかしかった](https://github.com/toasa/diary/blob/main/2025/09/23.md)ため）。
両者は同じメーカーで、価格の安さで購入を決めたのだが、どちらもハズレ。
今回はメーカーを変えて、GMKtec の[ミニPC](https://www.amazon.co.jp/dp/B0F4WZ43RF)にした。23,999円。
今回のスペックも１つ前と同じで、N150、メモリ16GB DDR4、SSD 512GB、HDMI 2.0 なのだが、
安定感が違う。
Windows を起動してから、グラフィックスは問題ないし、ファンはとても静か（エアコンの音の方が大きい）。
たまたま当たりを引いただけかもしれないけど、
前のメーカーはどうしても印象悪いし、
GMKtec の印象は上がる。

朝は５時近くに目が覚めた。
カフェが開くまで時間があるので、ミニPCを Windows/Ubuntu のデュアルブートにセットアップする。
おおまかな手順は以下：

1. Ubuntu の ISO イメージをダウンロード
    * [公式サイト](https://ubuntu.com/download/desktop)から Ubuntu Desktop をダウンロード。
    * Ubuntu 24.04.3 LTS にした
2. インストール用の USB メモリの作成
    * [Rufus](https://rufus.ie/)を使った。
    * 何のためにこの作業をするか、の自分の理解。PC は電源が入ると、はじめに BIOS/UEFI が動く。BIOS/UEFI はキーボードやHDDの初期化（デバイスの認識など）を行い、最後にブートローダを起動する。この BIOS/UEFI に Ubuntu 用のブートローダ (GRUB) を見つけてもらい、USB 内に配置したインストーラや Kernel から、Ubuntu をインストールするため。
    * 具体的な作業。１. パーティションの作成とフォーマット（作成したパーティションに、ファイルシステム (FAT32を選択) を構築）。２.ブートセクタの書き込み（パーティションの先頭のブートセクタにブートローダを書き込む）。3. ISO イメージの展開（Kernel本体、OSのインストーラなどを、フォーマット済みのUSBメモリのパーティション内に配置する）。
3. Windows のパーティション分割
    * もともとは Windows がストレージのすべての領域を占有しているため、Ubuntu 用の領域を確保する。
    * Windows に 230GB、Ubuntu に 250GBを割り当てた。
4. BIOS/UEFI の設定変更
    * 起動デバイスの優先順位を変更し、USB メモリを最優先させる
    * Secure boot も disable にした方がいいとのことだったが、自分の環境ではデフォルトで disable だった。
5. Ubuntu のインストール
    * BIOS/UEFI の起動画面で "Try or Install Ubuntu" を選択
    * Ubuntu のデスクトップ画面が表示され、インストールを進める。インストールの途中で、インストール種別を選択する画面が出る。"Install Ubuntu alongside Windows Boot Manager" を選択する。
6. デュアルブートの確認
    * 再起動後 GRUB の画面で、Ubuntu と Windows Boot Manager を選択できる。それぞれ選んでみて、どちらも起動できたらオッケー。

デュアルブートができたので、とりあえずは良さそう。
次は、Ubuntu に [Tailscale](https://tailscale.com/) を入れて、カフェとかから遠隔アクセスできるようにしたいな。
（昔はプロバイダから固定IPを買って、IP の払い出しとかやってたけど、今はそんな面倒はやらなくていいらしい。2025年よと）。

### Tailscale

お昼。カフェから帰ってきた。Tailscale のセットアップをやってみる。
セットアップといっても、公式サイトの手順に従うだけ。
Mac は Mac 用のアプリをインストールし、Linux は[インストール用のスクリプト](https://tailscale.com/kb/1031/install-linux#ubuntu)を叩くだけ。
とてもかんたん。
ping 応答もできて、カフェから ssh アクセスもできて、いうことなし。
カッコいい。

### systemd ターゲット

Ubuntu デスクトップをインストールしたので、デフォルトは GUI の GNONE が起動する。
基本的にはこれでいいんだけど、サーバー用途として使いたいこともあり、
その場合は GUI は不要で CUI モード？みたいなものが起動してくれればいい。
調べてみると、 systemd ターゲットを切り替えればいいらしい。

現在のデフォルトモードは `graphical.target` だった：

```
$ systemctl get-default
graphical.target
```

一時的にGUIなしで起動するようにする：

```
$ sudo systemctl isolate multi-user.target
```

再起動後、CUI モードで起動した。よしよし。

### 土曜日

米津玄師の "[IRIS OUT](https://www.youtube.com/watch?v=LmZD-TU96q4)" を聴く。
歌詞の中で「蕩尽」という熟語があり、知らなかった。
とうじんと読み、財産などを使い果たす、という意味らしい。
確かにお湯が尽きてそうではある。